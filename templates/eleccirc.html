{% extends "base.html" %}

{% block title %}Electrical Circuit Designer - {{ super() }}{% endblock %}

{% block styles %}
{{ super() }}
<style>
  .circuit-container {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 2rem;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
  }
  
  .circuit-canvas {
    width: 100%;
    min-height: 500px;
    background: #0a0e17;
    border-radius: 8px;
    margin: 1rem 0;
    padding: 1rem;
    position: relative;
    overflow: hidden;
  }
  
  .circuit-toolbar {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }
  
  .component-btn {
    background: #1e3a8a;
    color: white;
    border: none;
    padding: 0.5rem 1rem;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.2s;
  }
  
  .component-btn:hover {
    background: #1e40af;
  }
  
  .circuit-actions {
    margin-top: 1rem;
    display: flex;
    gap: 1rem;
  }
  
  .action-btn {
    padding: 0.5rem 1rem;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s;
  }
  
  .save-btn {
    background: #10b981;
    color: white;
  }
  
  .clear-btn {
    background: #ef4444;
    color: white;
  }
  
  .export-btn {
    background: #3b82f6;
    color: white;
  }
  
  .action-btn:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }
  
  /* Circuit.js specific styles */
  .circuitjs {
    width: 100%;
    height: 600px;
    border: 1px solid #2d3748;
    border-radius: 8px;
  }
</style>
{% endblock %}

{% block content %}<div id="bg-grid"></div>
<div class="circuit-container">
  <h1>Electrical Circuit Designer</h1>
  <p>Design and simulate electrical circuits in your browser</p>
  
  <div class="circuit-toolbar">
    <button class="component-btn" data-component="resistor">Resistor</button>
    <button class="component-btn" data-component="capacitor">Capacitor</button>
    <button class="component-btn" data-component="inductor">Inductor</button>
    <button class="component-btn" data-component="diode">Diode</button>
    <button class="component-btn" data-component="transistor">Transistor</button>
    <button class="component-btn" data-component="voltage">Voltage Source</button>
    <button class="component-btn" data-component="ground">Ground</button>
  </div>
  
  <div class="circuit-canvas">
    <!-- Circuit will be rendered here by Circuit.js -->
    <iframe class="circuitjs" src="https://www.falstad.com/circuit/circuitjs.html"></iframe>
  </div>
  
  <div class="circuit-actions">
    <button class="action-btn save-btn">Save Circuit</button>
    <button class="action-btn clear-btn">Clear Canvas</button>
    <button class="action-btn export-btn">Export as PNG</button>
  </div>
</div>
{% endblock %}

{% block scripts %}
{{ super() }}
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Add event listeners for component buttons
    const componentButtons = document.querySelectorAll('.component-btn');
    
    componentButtons.forEach(button => {
      button.addEventListener('click', function() {
        const componentType = this.getAttribute('data-component');
        // Here you would add logic to handle component addition
        console.log('Adding component:', componentType);
        // This would typically interact with Circuit.js or another circuit library
      });
    });
    
    // Handle action buttons
    const saveBtn = document.querySelector('.save-btn');
    const clearBtn = document.querySelector('.clear-btn');
    const exportBtn = document.querySelector('.export-btn');
    
    saveBtn.addEventListener('click', function() {
      // Save circuit logic
      alert('Circuit saved! (This is a placeholder)');
    });
    
    clearBtn.addEventListener('click', function() {
      if (confirm('Are you sure you want to clear the circuit?')) {
        // Clear circuit logic
        const iframe = document.querySelector('.circuitjs');
        iframe.src = iframe.src; // Reload the iframe to clear it
      }
    });
    
    exportBtn.addEventListener('click', function() {
      // Export as PNG logic
      alert('Exporting circuit as PNG (This is a placeholder)');
    });
    
    // Make the circuit canvas interactive
    // This is where you would initialize your circuit library
    // For example: const circuit = new Circuit('circuit-canvas');
  });
</script>
{% endblock %}
